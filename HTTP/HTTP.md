# HTTP

参考 -> https://github.com/jkchao/blog

## HTTP

> HTTP 协议，是 TCP/IP 协议的应用层协议。规定了客户端与服务器端的传输规则。

一般来说，从浏览器输入一个 URL 会执行以下步骤：

- 浏览器接收 URL，从中取出方案，服务器位置，以及资源路径。
- 检查缓存，如果资源命中强缓存，则直接读取缓存，不再发起网络请求。直接到最后一步 ，如果没有命中缓存，进行下一步。
- 如果服务器位置，并不是一个 IP 地址，则需要进行 DNS 域名解析，解析出对应的 ip 地址，如果是 ip 地址，则跳过，直接进行下一步。
- 通过 IP 地址与端口号建立一条到 Web 服务器的 TCP 连接。
- 通过这条连接，发送一条请求报文，当为 http 协议时，其中有 HTTP 三次握手，若为 HTTPS，多一个 secureConnection，即 SSL协议握手过程。此后每次解密都多加解密过程。
- 服务器处理请求， 并返回一个 HTTP 响应报文。
- 浏览器从服务器读取响应报文。
- 浏览器关闭连接，HTTP 四次挥手。
- 浏览器检查 HTTP header 里的状态码，并作出不同的处理方式。
- 如果是可以缓存的，这个响应则会被存储起来。
- 浏览器处理该响应

## TCP / IP 基本概念

参考 -> https://github.com/jkchao/blog/issues/14

> 在我大万维网世界中，TCP就像汽车，我们用TCP来运输数据，它很可靠，从来不会发生丢件少件的现象。但是如果路上跑的全是看起来一模一样的汽车，那这个世界看起来是一团混乱，送急件的汽车可能被前面满载货物的汽车拦堵在路上，整个交通系统一定会瘫痪。为了避免这种情况发生，交通规则HTTP诞生了。HTTP给汽车运输设定了好几个服务类别，有GET, POST, PUT, DELETE等等，HTTP规定，当执行GET请求的时候，要给汽车贴上GET的标签（设置method为GET），而且要求把传送的数据放在车顶上（url中）以方便记录。如果是POST请求，就要在车上贴上POST的标签，并把货物放在车厢里。当然，你也可以在GET的时候往车厢内偷偷藏点货物，但是这是很不光彩；也可以在POST的时候在车顶上也放一些数据，让人觉得傻乎乎的。HTTP只是个行为准则，而TCP才是GET和POST怎么实现的基本。



简单说 TCP 是运输数据的汽车，HTTP 是交通规则， methods 是汽车的标签类型 用于标志的汽车如何运输货物，运输公司则是 浏览器（（大多数）浏览器通常都会限制url长度在2K个字节，而（大多数）服务器最多处理64K大小的url）

世界上几乎所有的 HTTP 协议都是由 TCP / IP 协议来承载的。它是互联网相关的各类协议族的总称（通常所说的规则，就是协议）。

从输入的 URL 里我们可以从中获取服务器端的 IP 地址与端口号，建立一条 TCP 连接。建立连接之后，在客户端和服务器端之间交换的报文，不会丢失，受损，或者失序。分层

TCP / IP 协议族里最重要的特征就是分层，每一层都靠下一层的支持。TCP / IP 按层次分，分为四层：应用层、传输层、网络层、数据链路层。HTTPS 就是在应用层与传输层之间多了一层安全层。

![](/Users/yushifan/Documents/GitHub/about-blog/media/layered.png)

### 应用层

应用层决定了向用户提供应用服务时通信的活动（规定传输的数据格式）。

比如 FTP 文件传输协议，DNS 域名解析系统，HTTP 超文本传输协议也位于此层。

### 传输层

传输层提供处于网络连接中的两台计算机之间的数据传输，在传输层有两个不同的协议，TCP 和 UDP 协议。

### 网络层

网络层，用来处理网络上流动的数据包，数据包是网络传输的最小数据单位，该层规定了通过怎样的路径到达对方计算机，并把数据包传送给对方。

### 链路层

用来处理网络的硬件部分。如操作系统，设备驱动等。